# $Id$
# Maintainer: Arch Linux Pro Audio <dev@archaudio.org>
# Contributor: Ray Rashif <schivmeister@gmail.com>
# Contributor: Jon Kristian Nilsen <jokr.nilsen@gmail.com>

pkgname=ffado
_pkgname=libffado
pkgver=2.0.0
pkgrel=1
pkgdesc="Driver for FireWire audio devices"
arch=(i686 x86_64)
url="http://www.ffado.org/"
license=('GPL')
depends=('libiec61883' 'libavc1394' 'libxml++' 'dbus')
makedepends=('scons' 'pyqt')
optdepends=('pyqt: FFADO Mixer applet')
source=(http://www.ffado.org/files/$_pkgname-$pkgver.tar.gz)

build() {
  cd "$srcdir/$_pkgname-$pkgver"
  
  # Doesn't build with any kind of LDFLAGS
  unset LDFLAGS

  # this is needed when not using optimizations
  #sed -i "s/-march=i686/$CFLAGS/" SConstruct

  # not sure if sse(2) does anything harmful
  # to non-sse(2) machines at runtime
  scons PREFIX=/usr \
  	ENABLE_OPTIMIZATIONS=true || return 1
  scons DESTDIR="$pkgdir/" install
  	
  install -Dm644 support/xdg/hi64-apps-ffado.png \
    "$pkgdir/usr/share/pixmaps/$pkgname.png"
  install -Dm644 support/xdg/ffado.org-ffadomixer.desktop \
    "$pkgdir/usr/share/applications/ffadomixer.desktop"
}
md5sums=('89fd874731a1437043d0a57ed87c81ef')
